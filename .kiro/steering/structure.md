# Структура проекта

## Организация корневой директории

```
feedback-monorepo/
├── packages/                 # Пакеты Yarn workspace
│   ├── front/               # React фронтенд (VK Mini App)
│   └── back/                # Fastify бэкенд API
├── data/                    # Директория данных PostgreSQL (монтированный том)
├── doc/                     # Документация проекта
├── .env                     # Переменные окружения
├── docker-compose.yml       # Конфигурация продакшн развертывания
├── Dockerfile              # Сборка контейнера бэкенда
└── package.json            # Конфигурация корневого workspace
```

## Структура фронтенда (`packages/front/`)

```
packages/front/
├── src/
│   ├── components/          # Переиспользуемые UI компоненты
│   ├── pages/              # Компоненты страниц для конкретных роутов
│   ├── hooks/              # Кастомные React хуки
│   ├── context/            # React context провайдеры
│   ├── store/              # Управление состоянием Zustand
│   ├── utils/              # Утилитарные функции
│   ├── api/                # Функции API клиента
│   ├── types/              # Определения типов TypeScript
│   ├── App.tsx             # Главный компонент приложения
│   └── routes.ts           # Определения роутов
├── public/                 # Статические ресурсы
├── index.html              # HTML точка входа
├── vite.config.ts          # Конфигурация сборки Vite
├── tailwind.config.js      # Конфигурация Tailwind CSS
├── tsconfig.json           # Конфигурация TypeScript
├── vk-hosting-config.json  # Конфигурация развертывания VK хостинга
└── vk-tunnel-config.json   # Конфигурация VK туннеля для разработки
```

## Структура бэкенда (`packages/back/`)

```
packages/back/
├── src/
│   ├── modules/
│   │   ├── controllers/     # Обработчики запросов
│   │   ├── services/        # Слой бизнес-логики
│   │   ├── routers/         # Определения роутов
│   │   └── types/           # TypeScript интерфейсы
│   ├── api/                # Интеграции с внешними API (VK API)
│   ├── utils/              # Утилитарные функции
│   └── server.ts           # Точка входа приложения
├── prisma/
│   ├── schema.prisma       # Определение схемы базы данных
│   └── migrations/         # Файлы миграций базы данных
├── dist/                   # Скомпилированный вывод TypeScript
├── tsconfig.json           # Конфигурация TypeScript
├── Dockerfile             # Конфигурация сборки контейнера
└── package.json           # Зависимости пакета и скрипты
```

## Ключевые архитектурные паттерны

### Паттерны фронтенда
- **Компонентная архитектура**: Переиспользуемые компоненты с интеграцией VK UI
- **Context провайдеры**: Modal, Alert и Snackbar контексты для глобального состояния
- **Кастомные хуки**: Инкапсулированная логика для VK интеграции и получения данных
- **Разделение кода по роутам**: Каждый роут рендерится через общий компонент `Page`
- **Паттерн Store**: Zustand для управления клиентским состоянием

### Паттерны бэкенда
- **Модульная архитектура**: Контроллеры, сервисы и роутеры разделены по доменам
- **Слой сервисов**: Бизнес-логика абстрагирована от обработки HTTP
- **Валидация схем**: Zod схемы для валидации запросов/ответов
- **Слой базы данных**: Prisma ORM с типобезопасными операциями базы данных
- **Оптимизация производительности**: Lite версии запросов для сценариев высокой нагрузки

## Соглашения по именованию файлов

### Фронтенд
- **Компоненты**: PascalCase (например, `UserProfile.tsx`)
- **Хуки**: camelCase с префиксом `use` (например, `useLogin.ts`)
- **Утилиты**: kebab-case (например, `get-url-params.ts`)
- **Stores**: camelCase с суффиксом `Store` (например, `profileBtnStore.ts`)

### Бэкенд
- **Контроллеры**: kebab-case с суффиксом `.controller.ts`
- **Сервисы**: kebab-case с суффиксом `.service.ts`
- **Роутеры**: kebab-case с суффиксом `.router.ts`
- **Утилиты**: kebab-case (например, `check-server-load.ts`)

## Конфигурационные файлы

### Управление окружением
- **`.env`**: Переменные окружения для разработки
- **`docker-compose.yml`**: Конфигурация продакшн развертывания
- **VK-специфичные конфиги**: `vk-hosting-config.json`, `vk-tunnel-config.json`

### Конфигурация сборки
- **Фронтенд**: Vite с React SWC, Tailwind CSS и интеграцией Sentry
- **Бэкенд**: TypeScript в строгом режиме, генерация Prisma клиента
- **Docker**: Многоэтапные сборки для оптимизации продакшна

## Рабочий процесс разработки

1. **Настройка базы данных**: Запуск PostgreSQL через Docker Compose
2. **Разработка бэкенда**: Использование `yarn back:dev` для горячей перезагрузки
3. **Разработка фронтенда**: Использование `yarn front:dev` с VK туннелем для тестирования
4. **Изменения базы данных**: Создание миграций с `yarn back:prisma:migrate`
5. **Развертывание**: Сборка и деплой через Docker Compose с роутингом Traefik

## Важные директории для понимания

- **`data/`**: Постоянство данных PostgreSQL (не должно изменяться напрямую)
- **`doc/`**: Содержит документацию по оптимизации производительности и VK DON callback
- **`packages/back/prisma/`**: Управление схемой базы данных и миграциями
- **`packages/front/src/context/`**: Управление глобальным UI состоянием (модалки, алерты)
- **`packages/back/src/modules/`**: Организация основной бизнес-логики